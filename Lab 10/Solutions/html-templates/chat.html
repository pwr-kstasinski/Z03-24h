<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <meta charset="utf-8">
    <title>{% block title %} Account {% endblock %} - Messenger</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.4/socket.io.js"></script>
    <script src="http://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous"></script>


</head>

<body style="background-color: blanchedalmond">
    <nav>
    </nav>

    <div id="main-section">
        <nav id='sidebar'>
            
        </nav>
        <div id='right-side-panel'>
            <div id='display-message'>
                <h1
                    style="text-align: center; margin-top: 0px; top: 0px; left: 0px; right: 0px; position:fixed; background-color: mediumspringgreen;">
                    Your ID is : {{current_user.username}}
                </h1>
                <p id="messages"></p>
            </div>
            
            <div id='input-area'>
                <form action="{{ url_for('chat') }}" , method="POST">
                    <div style="text-align: center">
                        <br/>
                        <br />
                        {{ form.user(class_='form-control',
                        placeholder="user",
                        autocomplete='off',
                        autofocus=true) }}
                    </div>
                    <div style="text-align: center">
                        {{ form.submit_button }}
                    </div>
                
                    {{ form.csrf_token }}
                
                </form>

            </div>
            <div id='chat'>
                <h2 style="text-align: center">Your chats </h2>
                <hr/>
                <br/>
                {% for x in chat %}
                <p style="font-size: 20px;">User: <a href='http://127.0.0.1:5000/userchat/{{ x[4] }}'> <b>{{ x[0] }}</b></a></p>
                <p style="font-size: 12px;margin-bottom: 50px">{{ x[1] }} {{ x[2] }} {{ x[3] }}</p>
                {% endfor %}
            </div>
        </div>
        
    </div>


    
    
    <script type="text/javascript">
        $(document).ready(function () {

            var socket = io.connect('http://127.0.0.1:5000');

            socket.on('connect', function () {
                socket.send('User has connected!');
            });

            socket.on('message', function (msg) {
                $("#messages").append('<p>' + msg + '</p>');
                console.log('Received message');
            });

        });
    </script>


</body>

</html>